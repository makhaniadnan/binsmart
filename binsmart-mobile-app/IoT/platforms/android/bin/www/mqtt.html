<!DOCTYPE html>
<html>
<meta charset="UTF-8">

<head>
    <script type="text/javascript" src="js/mqttws31.js"></script>

    <script type="text/javascript" src="js/Long.min.js"></script>
    <script type="text/javascript" src="js/ByteBufferAB.min.js"></script>
    <script type="text/javascript" src="js/ProtoBuf.min.js"></script>
    <script type="text/javascript" src="js/fs.js"></script>
    <script type="text/javascript" src="js/bundle.js"></script>

</head>
<body>

<h2>A demo for showing the pub/sub between clients and the message broker</p> <h3>IoTGateway</h3>
    Topic :
    <input type="text" name="pub"/>
    Message:
    <input type="text" name="pub"/>
    <button onclick="connect()">
        Connect
    </button>
    <br>
    <button onclick="publish()">
        Publish
    </button>
    <br>

    <h3>BluetoothID</h3> Topic:
    <input type="text" name="sub"/>
    <button onclick="subscribe()">
        Subscribe
    </button>
    <br>
	<p id = "test"></p>
    <p id="sub"></p>
    <script>
			function publish() {
				document.getElementById("test").innerHTML = "entered pub button";
				window.mqtt = new navigator.mqtt_kura_plugin();
				window.mqtt.publish({
   		   			data: "plugin is working",
   		     		topic: "plugin"
  		  		});
  		  		document.getElementById("sub").innerHTML = "Pub success";
			}

			function subscribe() {
				document.getElementById("test").innerHTML = "entered subscribe button";
				window.mqtt = new navigator.mqtt_kura_plugin();
				window.mqtt.subscribe({
   		    		 topic: "plugin"
			    },
 			  	function(data){
     		   		console.log(data);
   			 	}
				);
				document.getElementById("sub").innerHTML = "Subscribe success";
			}



    </script>
</body>
</html>